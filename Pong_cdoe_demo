#include "Arduino_LED_Matrix.h"
ArduinoLEDMatrix matrix;

int br = 9600;
int dt = 200;
int xPos = 6;
int yPos = 4;
int deltaX = 1;
int deltaY = 1;

int butPin = 12;
int butPin2 = 11;
int butPin3 = 7;
int butPin4 = 6;
int myRow = 4;
int myRow2 = 5;
int myRow3 = 6;
int myRow4 = 4;
int myRow5 = 5;
int myRow6 = 6;
int butVal;
int butVal2;
int butVal3;
int butVal4;
int rowInc = 1;
int Time = 1;
int game_over = 0;

int i;
int j;

byte frame[8][12];
byte image1[8][12] = {
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
        { 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0 },
        { 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0 },
        { 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0 },
        { 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0 },
        { 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0 },
        { 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0 },
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }
      };
byte image2[8][12] = {
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
        { 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0 },
        { 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0 },
        { 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0 },
        { 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0 },
        { 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0 },
        { 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0 },
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }
      };
byte Win[8][12] = {
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
        { 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1 },
        { 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1 },
        { 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1 },
        { 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1 },
        { 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1 },
        { 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1 },
        { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }
      };

void setup() {
  Serial.begin(br);
  matrix.begin();
  pinMode(butPin, INPUT_PULLUP);
  pinMode(butPin2, INPUT_PULLUP);
  pinMode(butPin3, INPUT_PULLUP);
  pinMode(butPin4, INPUT_PULLUP);
}

void loop() {
  while (game_over != 1){
  butVal = digitalRead(butPin);
  butVal2 = digitalRead(butPin2);
  butVal3 = digitalRead(butPin3);
  butVal4 = digitalRead(butPin4);

  if (butVal == 0 && myRow3 != 7){
    myRow = myRow + rowInc;
    myRow2 = myRow2 + rowInc;
    myRow3 = myRow3 + rowInc;
  }
  if (butVal2 == 0 && myRow != 0){
    myRow = myRow - rowInc;
    myRow2 = myRow2 - rowInc;
    myRow3 = myRow3 - rowInc;
  }
  if (butVal3 == 0 && myRow6 != 7){
    myRow4 = myRow4 + rowInc;
    myRow5 = myRow5 + rowInc;
    myRow6 = myRow6 + rowInc;
  }
  if (butVal4 == 0 && myRow4 != 0){
    myRow4 = myRow4 - rowInc;
    myRow5 = myRow5 - rowInc;
    myRow6 = myRow6 - rowInc;
  }

    for (i = 0; i <= 11; i = i + 1){
      for (j = 0; j <= 7; j = j + 1){
        frame[j][i] = 0;
        if (i == xPos && j == yPos){
          frame[j][i] = 1;
        }
        if (i == 0 && j == myRow) {
          frame[j][i] = 1;
        }
        if (i == 0 && j == myRow2) {
          frame[j][i] = 1;
        }
        if (i == 0 && j == myRow3) {
          frame[j][i] = 1;
        }
        if (i == 11 && j == myRow4) {
          frame[j][i] = 1;
        }
        if (i == 11 && j == myRow5) {
          frame[j][i] = 1;
        }
        if (i == 11 && j == myRow6) {
          frame[j][i] = 1;
        }
      }
    }
    matrix.renderBitmap(frame,8,12);
      if (yPos>=7 || yPos<=0){
        deltaY = -deltaY;
      }
    if (xPos <= 0 && (yPos != myRow && yPos != myRow2 && yPos != myRow3)){
      Serial.println(yPos);
      Serial.println(myRow);
      Serial.println(myRow2);
      Serial.println(myRow3);
      matrix.renderBitmap(frame,8,12);
      frame[8][12] = 0;
      matrix.renderBitmap(image1,8,12);
      image1[8][12] = 1;
      delay(1000);
      matrix.renderBitmap(image1,8,12);
      image1[8][12] = 0;
      matrix.renderBitmap(Win,8,12);
      Win[8][12] = 1;
      game_over = 1;
    }
    if (xPos <= 0 && (yPos == myRow || yPos == myRow2 || yPos == myRow3)){
      deltaX = -deltaX;
    }

    if (xPos >= 11 && (yPos != myRow4 && yPos != myRow5 && yPos != myRow6)){
      Serial.println(yPos);
      Serial.println(myRow4);
      Serial.println(myRow5);
      Serial.println(myRow6);
      matrix.renderBitmap(frame,8,12);
      frame[8][12] = 0;
      matrix.renderBitmap(image2,8,12);
      image2[8][12] = 1;
      delay(1000);
      matrix.renderBitmap(image2,8,12);
      image2[8][12] = 0;
      matrix.renderBitmap(Win,8,12);
      Win[8][12] = 1;
      game_over = 1;
    }
    if (xPos >= 11 && (yPos == myRow4 || yPos == myRow5 || yPos == myRow6)){
      deltaX = -deltaX;
    }

    xPos=xPos+deltaX;
    yPos=yPos+deltaY;
   
    Time = Time + 1;
    delay(dt);
  }
}
